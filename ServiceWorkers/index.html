<html>
<meta charset="utf-8">
<title>CRTPWA</title>
<base href="/">
<meta name="viewport" content="width=device-width, initial-scale=1">
<link rel="manifest" href="manifest.json">
<script>
    if ('serviceWorker' in navigator) {
        window.addEventListener('load', function() {
            navigator.serviceWorker.register('/doWork.js').then(function(registration) {
                // Registration was successful
                console.log('ServiceWorker registration successful with scope: ', registration.scope);
            }, function(err) {
                // registration failed :(
                console.log('ServiceWorker registration failed: ', err);
            });
        });
    }
    var deferredPrompt;

    window.addEventListener('beforeinstallprompt', (e) => {
        // Prevent Chrome 67 and earlier from automatically showing the prompt
        e.preventDefault();
        // Stash the event so it can be triggered later.
        deferredPrompt = e;
    });

    function sayHI() {
        worker.postMessage({
            'cmd': 'start',
            'msg': 'Hi'
        });
    }

    function stop() {
        // worker.terminate() from this script would also stop the worker.
        worker.postMessage({
            'cmd': 'stop',
            'msg': 'Bye'
        });
    }

    function unknownCmd() {
        worker.postMessage({
            'cmd': 'foobard',
            'msg': '???'
        });
    }

    var worker = new Worker('doWork.js');

    worker.addEventListener('message', function(e) {
        document.getElementById('result').textContent = e.data;
    }, false);
</script>

<body>

</body>


</html>